(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],[,,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/header-logo.855a8c98.svg"},function(e,t,a){e.exports=a.p+"static/media/brush.34c46850.svg"},function(e,t,a){e.exports=a.p+"static/media/Lid.026bd200.svg"},function(e,t,a){e.exports=a.p+"static/media/Bin.949285d4.svg"},,,,function(e,t,a){e.exports=a(24)},,,,,function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(9),i=a.n(c),o=(a(22),a(16)),s=a(4),l=a.n(s),u=a(5),m=a(2),d=a(10),p=a.n(d);var f=function(){return r.a.createElement("header",{className:"header"},r.a.createElement("img",{src:p.a,alt:"Mesto-Russia",className:"header__logo"}))},b=a(11),_=a.n(b),v=a(12),h=a.n(v),O=a(13),j=a.n(O),k=Object(n.createContext)();var E=function(e){var t=e.imgLink,a=e.name,c=e.likesNumber,i=e.isLiked,o=e.handleCardClicked,s=e.cardOwnerId,l=e.onCardLike,u=e.c,m=e.onCardDelete,d=u,p=s===Object(n.useContext)(k)._id,f="delete-button ".concat(p?"":"delete-button_state_hidden"),b="like-button ".concat(i?"like-button_state_active":"");return r.a.createElement("div",{className:"card"},r.a.createElement("button",{className:f,onClick:function(){m(d)}},r.a.createElement("img",{src:h.a,alt:"\u041a\u0440\u044b\u0448\u043a\u0430",className:"delete-button__lid"}),r.a.createElement("img",{src:j.a,alt:"\u0423\u0440\u043d\u0430",className:"delete-button__bin"})),r.a.createElement("img",{src:t,className:"card__picture",alt:a,onClick:o}),r.a.createElement("div",{className:"card__bottom"},r.a.createElement("p",{className:"card__name"},a),r.a.createElement("div",{className:"like-section"},r.a.createElement("button",{className:b,onClick:function(){l(d)}}),r.a.createElement("p",{className:"like-section__likes-counter"},c))))};var g=function(e){var t=e.onEditProfile,a=e.onAddPlace,c=e.onEditAvatar,i=e.handleCardClicked,o=e.onCardLike,s=e.onCardDelete,l=e.cards,u=Object(n.useState)(!1),d=Object(m.a)(u,2),p=d[0],f=d[1],b=Object(n.useContext)(k),v=function(){f(!0)};return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile section"},r.a.createElement("div",{className:"profile-avatar"},r.a.createElement("img",{src:b.avatar,alt:b.name,className:"profile-avatar__image",onMouseEnter:v,onMouseLeave:function(){f(!1)}}),r.a.createElement("img",{src:_.a,alt:"\u041a\u0438\u0441\u0442\u043e\u0447\u043a\u0430",className:"profile-avatar__brush ".concat(p&&"profile-avatar__brush_state_visible"),onClick:c,onMouseEnter:v})),r.a.createElement("div",{className:"profile__info"},r.a.createElement("div",{className:"profile__info-line"},r.a.createElement("h2",{className:"profile__name"},b.name),r.a.createElement("button",{className:"edit-button profile__edit-button",onClick:t})),r.a.createElement("p",{className:"profile__description"},b.about)),r.a.createElement("button",{className:"add-button profile__add-button",onClick:a})),r.a.createElement("section",{className:"gallery section"},l.map((function(e){return r.a.createElement(E,Object.assign({key:e.cardId},e,{c:e,handleCardClicked:i,onCardLike:o,onCardDelete:s}))}))))};var N=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__text"},"\xa9 2020 Mesto Russia"))},C=function(e){var t=e.card,a=e.isOpen,n=e.onClose;return r.a.createElement("div",{className:"popup popup_type_picture ".concat(a&&"popup-opener")},r.a.createElement("div",{className:"popup__envelope"},r.a.createElement("button",{className:"close-button popup__close-button",type:"button",onClick:n}),r.a.createElement("img",{src:t.imgLink,alt:t.description,className:"popup__picture"}),r.a.createElement("p",{className:"popup__sign"},t.description)))},y=a(3),L=a(1),w=function(e){var t=e.title,a=e.name,n=e.isOpen,c=e.onClose,i=e.children,o=e.onSubmit,s=e.hasInvalid,l=e.buttonTitle,u=e.isLoading;return r.a.createElement("div",{className:"popup popup_type_".concat(a,"\n             ").concat(n&&"popup-opener","\n    ")},r.a.createElement("div",{className:"popup__window"},r.a.createElement("h2",{className:"popup__header"},t),r.a.createElement("button",{className:"close-button popup__close-button",type:"button",onClick:c}),r.a.createElement("form",{className:"form",name:a,noValidate:!0,onSubmit:o},i,r.a.createElement("button",{className:"submit-button form__submit-button ".concat(s?"submit-button_disabled":""),type:"submit",disabled:s},u?"\u0412\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c...":"".concat(l)))))};var S=function(e){var t=e.isOpen,a=e.onClose,c=e.onUpdateUser,i=Object(n.useState)(!1),o=Object(m.a)(i,2),s=o[0],l=o[1],u=Object(n.useState)({userName:"",userDescription:""}),d=Object(m.a)(u,2),p=d[0],f=d[1],b=Object(n.useState)({userName:!0,userDescription:!0}),_=Object(m.a)(b,2),v=_[0],h=_[1],O=Object(n.useState)(!1),j=Object(m.a)(O,2),E=j[0],g=j[1],N=Object(n.useState)({userName:"",userDescription:""}),C=Object(m.a)(N,2),S=C[0],x=C[1],I=Object(n.useContext)(k),P=function(e){var t=e.target,a=t.name,n=t.value,r=t.validity;f(Object(L.a)(Object(L.a)({},p),{},Object(y.a)({},a,n))),h(Object(L.a)(Object(L.a)({},v),{},Object(y.a)({},a,r.valid))),x(Object(L.a)(Object(L.a)({},S),{},Object(y.a)({},a,e.target.validationMessage)))};return Object(n.useEffect)((function(){v.userName&&v.userDescription?g(!1):g(!0)}),[p]),Object(n.useEffect)((function(){f(Object(L.a)(Object(L.a)({},p),{},{userName:I.name||"",userDescription:I.about||""})),h(Object(L.a)(Object(L.a)({},v),{},{userName:!0,userDescription:!0}))}),[I,t]),r.a.createElement(w,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"profile",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),l(!0),c({newName:p.userName,about:p.userDescription}),l(!1)},hasInvalid:E,isLoading:s,buttonTitle:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},r.a.createElement("fieldset",{className:"form__input-container"},r.a.createElement("label",{htmlFor:"name-input",className:"form__field"},r.a.createElement("input",{type:"text",name:"userName",placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",id:"name-input",className:"form__item form__item_content_name",required:!0,minLength:"2",maxLength:"40",onChange:P,value:p.userName}),r.a.createElement("span",{id:"name-input-error",className:"form__input-error ".concat(v.userName?"":"form__input-error_active")},S.userName)),r.a.createElement("label",{htmlFor:"description-input",className:"form__field"},r.a.createElement("input",{type:"text",name:"userDescription",placeholder:"\u0420\u043e\u0434 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438",id:"description-input",className:"form__item form__item_content_description",required:!0,minLength:"2",maxLength:"200",onChange:P,value:p.userDescription}),r.a.createElement("span",{id:"description-input-error",className:"form__input-error ".concat(v.userDescription?"":"form__input-error_active")},S.userDescription))))};var x=function(e){var t=e.isOpen,a=e.onClose,c=e.onUpdateAvatar,i=Object(n.useState)({avatarLink:""}),o=Object(m.a)(i,2),s=o[0],l=o[1],u=Object(n.useState)({avatarLink:!1}),d=Object(m.a)(u,2),p=d[0],f=d[1],b=Object(n.useState)(!0),_=Object(m.a)(b,2),v=_[0],h=_[1],O=Object(n.useState)({avatarLink:""}),j=Object(m.a)(O,2),k=j[0],E=j[1];Object(n.useEffect)((function(){p.avatarLink?h(!1):h(!0)}),[s]),Object(n.useEffect)((function(){l(Object(L.a)(Object(L.a)({},s),{},{avatarLink:""})),f(Object(L.a)(Object(L.a)({},p),{},{avatarLink:!1})),h(!0),E(Object(L.a)(Object(L.a)({},k),{},{avatarLink:""}))}),[t]);var g=Object(n.useRef)();return r.a.createElement(w,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),c(g.current.value)},hasInvalid:v},r.a.createElement("fieldset",{className:"form__input-container"},r.a.createElement("label",{htmlFor:"avatar-input",className:"form__field"},r.a.createElement("input",{type:"url",name:"avatarLink",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",id:"avatar-input",className:"form__item form__item_content_place-name ".concat(p.avatarLink?"":"form__item_type_error"),required:!0,ref:g,value:s.avatarLink,onChange:function(e){var t=e.target,a=t.name,n=t.value,r=t.validity;l(Object(L.a)(Object(L.a)({},s),{},Object(y.a)({},a,n))),f(Object(L.a)(Object(L.a)({},p),{},Object(y.a)({},a,r.valid))),E(Object(L.a)(Object(L.a)({},k),{},Object(y.a)({},a,e.target.validationMessage)))}}),r.a.createElement("span",{id:"avatar-input-error",className:"form__input-error ".concat(p.userName?"":"form__input-error_active")},k.avatarLink))))};var I=function(e){var t=e.isOpen,a=e.onClose,c=e.onAddPlace,i=Object(n.useState)(!1),o=Object(m.a)(i,2),s=o[0],l=o[1],u=Object(n.useState)({placeName:"",imgLink:""}),d=Object(m.a)(u,2),p=d[0],f=d[1],b=Object(n.useState)({placeName:!1,imgLink:!1}),_=Object(m.a)(b,2),v=_[0],h=_[1],O=Object(n.useState)(!0),j=Object(m.a)(O,2),k=j[0],E=j[1],g=Object(n.useState)({placeName:"",imgLink:""}),N=Object(m.a)(g,2),C=N[0],S=N[1],x=function(e){var t=e.target,a=t.name,n=t.value,r=t.validity;f(Object(L.a)(Object(L.a)({},p),{},Object(y.a)({},a,n))),h(Object(L.a)(Object(L.a)({},v),{},Object(y.a)({},a,r.valid))),S(Object(L.a)(Object(L.a)({},C),{},Object(y.a)({},a,e.target.validationMessage)))};return Object(n.useEffect)((function(){v.placeName&&v.imgLink?E(!1):E(!0)}),[p]),Object(n.useEffect)((function(){f(Object(L.a)(Object(L.a)({},p),{},{placeName:"",imgLink:""})),S(Object(L.a)(Object(L.a)({},C),{},{placeName:"",imgLink:""})),h(Object(L.a)(Object(L.a)({},v),{},{placeName:!1,imgLink:!1}))}),[t]),r.a.createElement(w,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"editor",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),l(!0),c({link:p.imgLink,name:p.placeName}),l(!1)},hasInvalid:k,buttonTitle:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isLoading:s},r.a.createElement("fieldset",{className:"form__input-container"},r.a.createElement("label",{htmlFor:"place-input",className:"form__field"},r.a.createElement("input",{type:"text",name:"placeName",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",id:"place-input",className:"form__item form__item_content_place-name ".concat(v.placeName?"":"form__item_type_error"),required:!0,minLength:"1",onChange:x,value:p.placeName}),r.a.createElement("span",{id:"place-input-error",className:"form__input-error ".concat(v.userName?"":"form__input-error_active")},C.placeName)),r.a.createElement("label",{htmlFor:"link-input",className:"form__field"},r.a.createElement("input",{type:"url",name:"imgLink",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",id:"link-input",className:"form__item form__item_content_place-name ".concat(v.imgLink?"":"form__item_type_error"),required:!0,onChange:x,value:p.imgLink}),r.a.createElement("span",{id:"link-input-error",className:"form__input-error ".concat(v.userName?"":"form__input-error_active")},C.imgLink))))};var P=function(e){var t=e.isOpen,a=e.onClose,c=e.cardId,i=e.action,o=Object(n.useState)(!1),s=Object(m.a)(o,2),l=s[0],u=s[1];return r.a.createElement(w,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"confirmation",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),u(!0),i(c),a(),u(!1)},hasInvalid:!1,isLoading:l,buttonTitle:"\u0414\u0430"})},U=a(14),D=a(15),T=new(function(){function e(t){var a=t.baseUrl,n=t.token;Object(U.a)(this,e),this._baseUrl=a,this._token=n}return Object(D.a)(e,[{key:"_resultsProcessing",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._baseUrl,"cards"),{headers:{authorization:this._token,"content-type":"application/json"}}).then((function(t){return e._resultsProcessing(t)})).catch((function(e){console.log(e)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._baseUrl,"users/me"),{headers:{authorization:this._token,"content-type":"application/json"}}).then((function(t){return e._resultsProcessing(t)})).catch((function(e){console.log(e)}))}},{key:"sendUserInfo",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.newName,about:e.about})}).then((function(e){return t._resultsProcessing(e)})).catch((function(e){console.log(e)}))}},{key:"getCardId",value:function(e){this._cardId=e._id}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"cards/").concat(e),{method:"DELETE",headers:{authorization:this._token,"content-type":"application/json"}}).then((function(e){return t._resultsProcessing(e)})).catch((function(e){console.log(e)}))}},{key:"likeCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"cards/likes/").concat(e),{method:"PUT",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(e){return t._resultsProcessing(e)})).catch((function(e){console.log(e)}))}},{key:"dislikeCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"cards/likes/").concat(e),{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json"}}).then((function(e){return t._resultsProcessing(e)})).catch((function(e){console.log(e)}))}},{key:"uploadCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"cards"),{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return t._resultsProcessing(e)})).catch((function(e){console.log(e)}))}},{key:"uploadAvatar",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){return t._resultsProcessing(e)})).catch((function(e){console.log(e)}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-14/",token:"614c831a-d135-4d7c-82ff-12ed74000dec"}),A=Object(n.createContext)(),M=function(e,t){return{imgLink:e.link,name:e.name,likes:e.likes,likesNumber:Object.keys(e.likes).length,isLiked:e.likes.some((function(e){return e._id===t._id})),cardOwnerId:e.owner._id,cardId:e._id}};var z=function(){var e=Object(n.useState)({}),t=Object(m.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)(!1),s=Object(m.a)(i,2),d=s[0],p=s[1],b=Object(n.useState)(!1),_=Object(m.a)(b,2),v=_[0],h=_[1],O=Object(n.useState)(!1),j=Object(m.a)(O,2),E=j[0],y=j[1],L=Object(n.useState)(!1),w=Object(m.a)(L,2),U=w[0],D=w[1],z=Object(n.useState)(!1),q=Object(m.a)(z,2),F=q[0],J=q[1],B=Object(n.useState)({}),R=Object(m.a)(B,2),H=R[0],W=R[1],V=Object(n.useState)([]),$=Object(m.a)(V,2),G=$[0],K=$[1];Object(n.useEffect)((function(){(function(){var e=Object(u.a)(l.a.mark((function e(){var t,a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getUserInfo();case 2:return t=e.sent,e.next=5,T.getInitialCards();case 5:a=e.sent,n=a.map((function(e){return M(e,t)})),K(n),c(t);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var Q=function(){p(!1),h(!1),y(!1),J(!1),D(!1),window.removeEventListener("keydown",X)},X=function(e){"Escape"===e.key&&Q()},Y=function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.sendUserInfo(t);case 2:a=e.sent,c(a),Q();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.uploadAvatar(t);case 2:a=e.sent,c(a),Q();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isLiked){e.next=6;break}return e.next=3,T.dislikeCard(t.cardId);case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,T.likeCard(t.cardId);case 8:e.t0=e.sent;case 9:n=e.t0,r=M(n,a),c=G.map((function(e){return e.cardId===t.cardId?r:e})),K(c);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.deleteCard(t);case 2:a=G.filter((function(e){return e.cardId!==t})),K(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.uploadCard(t);case 2:n=e.sent,r=M(n,a),K([r].concat(Object(o.a)(G))),h(!1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"root"},r.a.createElement(k.Provider,{value:a},r.a.createElement(A.Provider,{value:G},r.a.createElement(f,null),r.a.createElement(g,{onEditProfile:function(){p(!0),window.addEventListener("keydown",X)},onAddPlace:function(){h(!0),window.addEventListener("keydown",X)},onEditAvatar:function(){y(!0),window.addEventListener("keydown",X)},handleCardClicked:function(e){var t={imgLink:e.target.src,description:e.target.alt};W(t),J(!0),window.addEventListener("keydown",X)},cards:G,onCardLike:ee,onCardDelete:function(e){W(e),D(!0)}}),r.a.createElement(N,null),r.a.createElement(C,{card:H,isOpen:F,onClose:Q}),r.a.createElement(S,{isOpen:d,onClose:Q,onUpdateUser:Y}),r.a.createElement(I,{isOpen:v,onClose:Q,onAddPlace:ae}),r.a.createElement(x,{isOpen:E,onClose:Q,onUpdateAvatar:Z}),r.a.createElement(P,{isOpen:U,onClose:Q,cardId:H.cardId,action:te}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[17,1,2]]]);
//# sourceMappingURL=main.0597aefb.chunk.js.map